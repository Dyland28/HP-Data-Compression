DROP TABLE CAPSTONE.TABLE_TYPES;
CREATE TABLE CAPSTONE.TABLE_TYPES

(
TABLE_TYPE VARCHAR2(32),
TABLE_DESCRIPTION VARCHAR2(1000)
);

INSERT INTO CAPSTONE.TABLE_TYPES(TABLE_TYPE, TABLE_DESCRIPTION) VALUES('NORM', 'Normalized where we store the key instead of the VARCHAR');
INSERT INTO CAPSTONE.TABLE_TYPES(TABLE_TYPE, TABLE_DESCRIPTION) VALUES('DENORM', 'Denormalized where we store the VARCHAR instead of the KEY');
COMMIT;

DROP TABLE CAPSTONE.TABLESPACE_TYPES;
CREATE TABLE CAPSTONE.TABLESPACE_TYPES

(
TABLESPACE_NAME VARCHAR2(32),
BLOCK_SIZE_BYTES NUMBER,
TABLESPACE_DESCRIPTION VARCHAR2(1000)
);

INSERT INTO CAPSTONE.TABLESPACE_TYPES(TABLESPACE_NAME, BLOCK_SIZE_BYTES, TABLESPACE_DESCRIPTION) VALUES('CAP8K', 8192, '8K');
INSERT INTO CAPSTONE.TABLESPACE_TYPES(TABLESPACE_NAME, BLOCK_SIZE_BYTES, TABLESPACE_DESCRIPTION) VALUES('CAP16K', 16384, '16K');
INSERT INTO CAPSTONE.TABLESPACE_TYPES(TABLESPACE_NAME, BLOCK_SIZE_BYTES, TABLESPACE_DESCRIPTION) VALUES('CAP32K', 32768, '32K');
COMMIT;

DROP TABLE CAPSTONE.COMPRESSION_TYPES;
CREATE TABLE CAPSTONE.COMPRESSION_TYPES

(
OBJECT_TYPE VARCHAR2(32),
COMPRESSION_SYNTAX VARCHAR2(32),
COMPRESSION_DESCRIPTION VARCHAR2(32)
);

INSERT INTO CAPSTONE.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','NOCOMPRESS', 'NOCOMPRESS');
INSERT INTO CAPSTONE.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','COMPRESS BASIC', 'BASIC');
INSERT INTO CAPSTONE.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','ROW STORE COMPRESS ADVANCED', 'ADVANCED');
COMMIT;

CREATE TABLE CAPSTONE.VARCHAR_LENGTH
(
VARCHAR_LENGTH NUMBER,
DESCRIPTION VARCHAR2(1000)
);

INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(1,'L1');
INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(2,'L2');
INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(4,'L4');
INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(8,'L8');
INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(16,'L16');
INSERT INTO CAPSTONE.VARCHAR_LENGTH(VARCHAR_LENGTH,DESCRIPTION) VALUES(32,'L32');
COMMIT;

CREATE TABLE CAPSTONE.BLOCK_CARDINALITY
(
BLOCK_CARDINALITY NUMBER,
DESCRIPTION VARCHAR2(1000)
);

INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(1,'BC1');
INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(2,'BC2');
INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(4,'BC4');
INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(8,'BC8');
INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(16,'BC16');
INSERT INTO CAPSTONE.BLOCK_CARDINALITY(BLOCK_CARDINALITY,DESCRIPTION) VALUES(32,'BC32');
COMMIT;

SELECT
    A.SHORT_TABLE_NAME,
    B.TABLESPACE_NAME,
    C.COMPRESSION_SYNTAX,
    'DROP TABLE CAPSTONE.' || A.SHORT_TABLE_NAME || '_' || B.TABLESPACE_DESCRIPTION || '_' || C.COMPRESSION_DESCRIPTION || ';' AS DROP_TABLE_SYNTAX,
    'CREATE TABLE CAPSTONE.' || A.SHORT_TABLE_NAME || '_' || B.TABLESPACE_DESCRIPTION || '_' || C.COMPRESSION_DESCRIPTION || ' ' || C.COMPRESSION_SYNTAX || ' PCTFREE 0 TABLESPACE ' || B.TABLESPACE_NAME || ' STORAGE(INITIAL ' || 5*B.BLOCK_SIZE_BYTES || ' NEXT ' || 5*B.BLOCK_SIZE_BYTES || ')' || ' AS SELECT * FROM CAPSTONE.' || A.BASE_TABLE_NAME || ';' AS CREATE_TABLE_STATEMENT
FROM CAPSTONE.TABLE_TYPES A
    CROSS JOIN CAPSTONE.TABLESPACE_TYPES B
    CROSS JOIN CAPSTONE.COMPRESSION_TYPES C
WHERE C.OBJECT_TYPE = 'TABLE'
ORDER BY
    A.BASE_TABLE_NAME,
    B.TABLESPACE_NAME,
    C.COMPRESSION_SYNTAX;
    
DROP TABLE CAPSTONE.T1_16K_BASIC;
DROP TABLE CAPSTONE.T1_16K_NOCOMPRESS;
DROP TABLE CAPSTONE.T1_16K_ADVANCED;
DROP TABLE CAPSTONE.T1_32K_BASIC;
DROP TABLE CAPSTONE.T1_32K_NOCOMPRESS;
DROP TABLE CAPSTONE.T1_32K_ADVANCED;
DROP TABLE CAPSTONE.T1_8K_BASIC;
DROP TABLE CAPSTONE.T1_8K_NOCOMPRESS;
DROP TABLE CAPSTONE.T1_8K_ADVANCED;

