DROP TABLE KIRBYS.TABLE_TYPES;
CREATE TABLE KIRBYS.TABLE_TYPES

(
BASE_TABLE_NAME VARCHAR2(32),
SHORT_TABLE_NAME VARCHAR(32),
TABLE_DESCRIPTION VARCHAR2(1000)
);

INSERT INTO KIRBYS.TABLE_TYPES(BASE_TABLE_NAME, SHORT_TABLE_NAME, TABLE_DESCRIPTION) VALUES('T1_BASE', 'T1', 'NUMBER, TIMESTAMP, NUMBER');
INSERT INTO KIRBYS.TABLE_TYPES(BASE_TABLE_NAME, SHORT_TABLE_NAME, TABLE_DESCRIPTION) VALUES('T2_BASE', 'T2', 'VARCHAR2, TIMESTAMP, NUMBER');
COMMIT;

DROP TABLE KIRBYS.TABLESPACE_TYPES;
CREATE TABLE KIRBYS.TABLESPACE_TYPES

(
TABLESPACE_NAME VARCHAR2(32),
TABLESPACE_DESCRIPTION VARCHAR2(1000)
);

INSERT INTO KIRBYS.TABLESPACE_TYPES(TABLESPACE_NAME, TABLESPACE_DESCRIPTION) VALUES('CAP_8K', '8K');
INSERT INTO KIRBYS.TABLESPACE_TYPES(TABLESPACE_NAME, TABLESPACE_DESCRIPTION) VALUES('CAP_16K', '16K');
INSERT INTO KIRBYS.TABLESPACE_TYPES(TABLESPACE_NAME, TABLESPACE_DESCRIPTION) VALUES('CAP_32K', '32K');
COMMIT;

DROP TABLE KIRBYS.COMPRESSION_TYPES;
CREATE TABLE KIRBYS.COMPRESSION_TYPES

(
OBJECT_TYPE VARCHAR2(32),
COMPRESSION_SYNTAX VARCHAR2(32),
COMPRESSION_DESCRIPTION VARCHAR2(32)
);

INSERT INTO KIRBYS.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','NOCOMPRESS', 'NOCOMPRESS');
INSERT INTO KIRBYS.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','COMPRESS BASIC', 'BASIC');
INSERT INTO KIRBYS.COMPRESSION_TYPES(OBJECT_TYPE, COMPRESSION_SYNTAX, COMPRESSION_DESCRIPTION) VALUES('TABLE','ROW STORE COMPRESS ADVANCED', 'ADVANCED');
COMMIT;

SELECT
    A.SHORT_TABLE_NAME,
    B.TABLESPACE_NAME,
    C.COMPRESSION_SYNTAX,
    'CREATE TABLE ' || A.SHORT_TABLE_NAME || '_' || B.TABLESPACE_DESCRIPTION || '_' || C.COMPRESSION_DESCRIPTION || ' ' || C.COMPRESSION_SYNTAX || ' TABLESPACE ' || B.TABLESPACE_NAME || ' AS SELECT * FROM ' || A.BASE_TABLE_NAME || ';' AS CREATE_TABLE_STATEMENT
FROM KIRBYS.TABLE_TYPES A
    CROSS JOIN KIRBYS.TABLESPACE_TYPES B
    CROSS JOIN KIRBYS.COMPRESSION_TYPES C
WHERE C.OBJECT_TYPE = 'TABLE'
ORDER BY
    A.BASE_TABLE_NAME,
    B.TABLESPACE_NAME,
    C.COMPRESSION_SYNTAX;